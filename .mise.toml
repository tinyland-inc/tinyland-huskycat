# Mise (formerly rtx) - Polyglot Tool Version Manager
# https://mise.jdx.dev/
#
# Usage:
#   mise install      # Install all tools
#   mise run validate # Run validation task
#   mise shell        # Enter shell with all tools

[tools]
python = "3.11"
uv = "0.5.8"
node = "20"
shellcheck = "0.10.0"

[env]
PYTHONPATH = "{{config_root}}/src"
HUSKYCAT_MODE = "cli"

# Task definitions (replaces simple Makefile targets)
[tasks.validate]
description = "Run HuskyCat validation on current directory"
run = "uv run python -m huskycat validate"

[tasks.test]
description = "Run all tests"
run = "uv run pytest tests/ -v"

[tasks.test-pbt]
description = "Run property-based tests"
run = "uv run pytest tests/test_*pbt.py -v --hypothesis-profile=ci"

[tasks.lint]
description = "Run linters"
run = """
uv run ruff check src/ tests/
uv run mypy src/
"""

[tasks.format]
description = "Format code"
run = "uv run ruff format src/ tests/"

[tasks.build]
description = "Build binary"
run = "npm run build:binary"

[tasks.docs]
description = "Build documentation"
run = "npm run docs:build"

[tasks.clean]
description = "Clean build artifacts"
run = "rm -rf dist/ build/ *.egg-info .pytest_cache .mypy_cache .ruff_cache"

[tasks.status]
description = "Show HuskyCat status"
run = "uv run python -m huskycat status"
